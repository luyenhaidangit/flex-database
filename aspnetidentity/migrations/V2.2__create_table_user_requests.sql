-- USER_REQUESTS for maker-checker workflow of USERS
CREATE TABLE USER_REQUESTS
(
    ID             NUMBER(19)        GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    ENTITY_ID      NUMBER(19),
    ACTION         VARCHAR2(20 CHAR) NOT NULL,
    STATUS         VARCHAR2(10 CHAR) DEFAULT 'PENDING' NOT NULL,
    REQUESTED_DATA CLOB              NOT NULL,
    COMMENTS       NVARCHAR2(500),
    MAKER_ID       VARCHAR2(256 CHAR) NOT NULL,
    REQUESTED_DATE TIMESTAMP(6)      DEFAULT CURRENT_TIMESTAMP NOT NULL,
    CHECKER_ID     VARCHAR2(256 CHAR),
    APPROVE_DATE   TIMESTAMP(6)
)
/

CREATE INDEX IX_USER_REQUESTS_ENTITY_ID ON USER_REQUESTS (ENTITY_ID)
/
CREATE INDEX IX_USER_REQUESTS_STATUS ON USER_REQUESTS (STATUS)
/
CREATE INDEX IX_USER_REQUESTS_MAKER_ID ON USER_REQUESTS (MAKER_ID)
/
CREATE INDEX IX_USER_REQUESTS_CHECKER_ID ON USER_REQUESTS (CHECKER_ID)
/

COMMENT ON TABLE USER_REQUESTS IS 'User approval requests for maker-checker workflow';
COMMENT ON COLUMN USER_REQUESTS.STATUS IS 'Request status: DRAFT, PENDING, APPROVED, REJECTED, CANCELLED';
COMMENT ON COLUMN USER_REQUESTS.ACTION IS 'Action type: CREATE, UPDATE, DELETE, ACTIVATE, DEACTIVATE';
COMMENT ON COLUMN USER_REQUESTS.REQUESTED_DATA IS 'JSON data containing user information';
/



